<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="表单字段的使用在model-form中内置了大量的form组件来帮助你快速的构建form表单  公共方法 设置表单值 (value)1$form-&gt;text(&#x27;title&#x27;)-&gt;value(&#x27;text...&#x27;);   设置默认值 (default)1$form-&gt;text(&#x27;title&#x27;)-&gt;default(&amp;#x">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2023/11/25/2.x/model-form-fields/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="表单字段的使用在model-form中内置了大量的form组件来帮助你快速的构建form表单  公共方法 设置表单值 (value)1$form-&gt;text(&#x27;title&#x27;)-&gt;value(&#x27;text...&#x27;);   设置默认值 (default)1$form-&gt;text(&#x27;title&#x27;)-&gt;default(&amp;#x">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.learnku.com/uploads/images/202112/12/38389/ArVNSvChag.png!large">
<meta property="og:image" content="https://cdn.learnku.com/uploads/images/202104/30/38389/oChwzky2BT.gif!large">
<meta property="og:image" content="http://example.com/assets/img/screenshots/has-many-table.png">
<meta property="article:published_time" content="2023-11-25T07:16:44.964Z">
<meta property="article:modified_time" content="2023-11-25T07:16:44.964Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.learnku.com/uploads/images/202112/12/38389/ArVNSvChag.png!large">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-2.x/model-form-fields" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/11/25/2.x/model-form-fields/" class="article-date">
  <time class="dt-published" datetime="2023-11-25T07:16:44.964Z" itemprop="datePublished">2023-11-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="表单字段的使用"><a href="#表单字段的使用" class="headerlink" title="表单字段的使用"></a>表单字段的使用</h1><p>在<code>model-form</code>中内置了大量的form组件来帮助你快速的构建form表单</p>
<p><a name="public"></a></p>
<h2 id="公共方法"><a href="#公共方法" class="headerlink" title="公共方法"></a>公共方法</h2><p><a name="value"></a></p>
<h3 id="设置表单值-value"><a href="#设置表单值-value" class="headerlink" title="设置表单值 (value)"></a>设置表单值 (value)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;title&#x27;</span>)-&gt;<span class="title function_ invoke__">value</span>(<span class="string">&#x27;text...&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="default"></a></p>
<h3 id="设置默认值-default"><a href="#设置默认值-default" class="headerlink" title="设置默认值 (default)"></a>设置默认值 (default)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;title&#x27;</span>)-&gt;<span class="keyword">default</span>(<span class="string">&#x27;text...&#x27;</span>);</span><br></pre></td></tr></table></figure>



<p>此方法仅在<strong>新增页面</strong>有效，如果<strong>编辑页面</strong>也需要设置默认值，可以参考以下方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;xxx&#x27;</span>)-&gt;<span class="keyword">default</span>(<span class="string">&#x27;默认值&#x27;</span>, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure>

<p><a name="help"></a></p>
<h3 id="设置提示信息-help"><a href="#设置提示信息-help" class="headerlink" title="设置提示信息 (help)"></a>设置提示信息 (help)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;title&#x27;</span>)-&gt;<span class="title function_ invoke__">help</span>(<span class="string">&#x27;help...&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="attr"></a></p>
<h3 id="设置属性-attribute"><a href="#设置属性-attribute" class="headerlink" title="设置属性 (attribute)"></a>设置属性 (attribute)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;title&#x27;</span>)-&gt;<span class="title function_ invoke__">attribute</span>([<span class="string">&#x27;data-title&#x27;</span> =&gt; <span class="string">&#x27;title...&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;title&#x27;</span>)-&gt;<span class="title function_ invoke__">attribute</span>(<span class="string">&#x27;data-title&#x27;</span>, <span class="string">&#x27;title...&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="required"></a></p>
<h3 id="设置为必填-required"><a href="#设置为必填-required" class="headerlink" title="设置为必填 (required)"></a>设置为必填 (required)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;title&#x27;</span>)-&gt;<span class="title function_ invoke__">required</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不显示&quot;*&quot;号</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;title&#x27;</span>)-&gt;<span class="title function_ invoke__">required</span>(<span class="literal">false</span>);</span><br></pre></td></tr></table></figure>

<p><a name="disable"></a></p>
<h3 id="设置为不可编辑-disable"><a href="#设置为不可编辑-disable" class="headerlink" title="设置为不可编辑 (disable)"></a>设置为不可编辑 (disable)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;title&#x27;</span>)-&gt;<span class="title function_ invoke__">disable</span>();</span><br></pre></td></tr></table></figure>

<p><a name="placeholder"></a></p>
<h3 id="设置占位符-placeholder"><a href="#设置占位符-placeholder" class="headerlink" title="设置占位符 (placeholder)"></a>设置占位符 (placeholder)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;title&#x27;</span>)-&gt;<span class="title function_ invoke__">placeholder</span>(<span class="string">&#x27;请输入。。。&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="setWidth"></a></p>
<h3 id="设置宽度-width"><a href="#设置宽度-width" class="headerlink" title="设置宽度 (width)"></a>设置宽度 (width)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;title&#x27;</span>)-&gt;<span class="title function_ invoke__">width</span>(<span class="number">8</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<p><a name="rules"></a></p>
<h3 id="设置验证规则-rules"><a href="#设置验证规则-rules" class="headerlink" title="设置验证规则 (rules)"></a>设置验证规则 (rules)</h3><p>具体使用可参考<a href="model-form-validation.md">表单验证</a>。</p>
<p><a name="saving"></a></p>
<h3 id="修改待保存的表单输入值-saving"><a href="#修改待保存的表单输入值-saving" class="headerlink" title="修改待保存的表单输入值 (saving)"></a>修改待保存的表单输入值 (saving)</h3><p>通过<code>saving</code>方法可以更改待保存数据的格式。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Support</span>\<span class="title">Helper</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleFile</span>(<span class="string">&#x27;files&#x27;</span>)-&gt;<span class="title function_ invoke__">saving</span>(function (<span class="variable">$paths</span>) &#123;</span><br><span class="line">    <span class="variable">$paths</span> = <span class="title class_">Helper</span>::<span class="keyword">array</span>(<span class="variable">$paths</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取数据库当前行的其他字段</span></span><br><span class="line">    <span class="variable">$username</span> = <span class="variable language_">$this</span>-&gt;username;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 最终转化为json保存到数据库</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$paths</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><a name="customFormat"></a></p>
<h3 id="修改表单数据显示-customFormat"><a href="#修改表单数据显示-customFormat" class="headerlink" title="修改表单数据显示 (customFormat)"></a>修改表单数据显示 (customFormat)</h3><p>通过<code>customFormat</code>方法可以改变从外部注入到表单的字段值。</p>
<p>如下例子中，<code>multipleFile</code>字段要求待渲染的字段值为数组格式，我们可以通过<code>customFormat</code>方法把从数据库查出的字段值转化为<code>array</code>格式</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Support</span>\<span class="title">Helper</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleFile</span>(<span class="string">&#x27;files&#x27;</span>)-&gt;<span class="title function_ invoke__">saving</span>(function (<span class="variable">$paths</span>) &#123;</span><br><span class="line">    <span class="variable">$paths</span> = <span class="title class_">Helper</span>::<span class="keyword">array</span>(<span class="variable">$paths</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$paths</span>);</span><br><span class="line">&#125;)-&gt;<span class="title function_ invoke__">customFormat</span>(function (<span class="variable">$paths</span>) &#123;</span><br><span class="line">	<span class="comment">// 获取数据库当前行的其他字段</span></span><br><span class="line">    <span class="variable">$username</span> = <span class="variable language_">$this</span>-&gt;username;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 转为数组</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Helper</span>::<span class="keyword">array</span>(<span class="variable">$paths</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="在弹窗中隐藏"><a href="#在弹窗中隐藏" class="headerlink" title="在弹窗中隐藏"></a>在弹窗中隐藏</h3><p>如果不想在弹窗中显示某个字段，可以使用<code>Form\Field::hideInDialog</code>方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;title&#x27;</span>);</span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">textarea</span>(<span class="string">&#x27;contents&#x27;</span>)-&gt;<span class="title function_ invoke__">hideInDialog</span>();</span><br></pre></td></tr></table></figure>

<h3 id="保存为字符串类型-saveAsString"><a href="#保存为字符串类型-saveAsString" class="headerlink" title="保存为字符串类型 saveAsString"></a>保存为字符串类型 <code>saveAsString</code></h3><p><code>saveAsString</code>方法可以把表单值转化为<code>string</code>类型保存，当保存的数据库字段值不允许为<code>null</code>时非常有用；</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;nickname&#x27;</span>)-&gt;<span class="title function_ invoke__">saveAsString</span>();</span><br></pre></td></tr></table></figure>

<h3 id="保存为json类型-saveAsJson"><a href="#保存为json类型-saveAsJson" class="headerlink" title="保存为json类型 saveAsJson"></a>保存为json类型 <code>saveAsJson</code></h3><p><code>saveAsJson</code>可以把表单值保存为<code>json</code>格式</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;nickname&#x27;</span>)-&gt;<span class="title function_ invoke__">saveAsJson</span>();</span><br></pre></td></tr></table></figure>


<p><a name="text"></a></p>
<h2 id="文本-text"><a href="#文本-text" class="headerlink" title="文本 (text)"></a>文本 (text)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="variable">$column</span>, [<span class="variable">$label</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加提交验证规则</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="variable">$column</span>, [<span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">rules</span>(<span class="string">&#x27;required|min:10&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="hidden"></a></p>
<h2 id="隐藏字段-hidden"><a href="#隐藏字段-hidden" class="headerlink" title="隐藏字段 (hidden)"></a>隐藏字段 (hidden)</h2><p>通过<code>hidden</code>方法可以给你的表单设置一个隐藏字段。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">hidden</span>(<span class="string">&#x27;author_id&#x27;</span>)-&gt;<span class="title function_ invoke__">value</span>(<span class="title class_">Admin</span>::<span class="title function_ invoke__">user</span>()-&gt;<span class="title function_ invoke__">getKey</span>());</span><br></pre></td></tr></table></figure>

<p>通常可以结合<code>saving</code>事件使用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">hidden</span>(<span class="string">&#x27;author_id&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">saving</span>(function (Form <span class="variable">$form</span>) &#123;</span><br><span class="line">    <span class="variable">$form</span>-&gt;author_id = <span class="title class_">Admin</span>::<span class="title function_ invoke__">user</span>()-&gt;<span class="title function_ invoke__">getKey</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>


<p><a name="select"></a></p>
<h2 id="下拉选框单选-select"><a href="#下拉选框单选-select" class="headerlink" title="下拉选框单选 (select)"></a>下拉选框单选 (select)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">options</span>([<span class="number">1</span> =&gt; <span class="string">&#x27;foo&#x27;</span>, <span class="number">2</span> =&gt; <span class="string">&#x27;bar&#x27;</span>, <span class="string">&#x27;val&#x27;</span> =&gt; <span class="string">&#x27;Option name&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>或者从api中获取选项列表：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">options</span>(<span class="string">&#x27;/api/users&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用ajax并显示所选项目</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">options</span>(<span class="title class_">Model</span>::<span class="variable language_">class</span>)-&gt;<span class="title function_ invoke__">ajax</span>(<span class="string">&#x27;/api/users&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或指定名称和ID</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">options</span>(<span class="title class_">Model</span>::<span class="variable language_">class</span>, <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;id&#x27;</span>)-&gt;<span class="title function_ invoke__">ajax</span>(<span class="string">&#x27;/api/users&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>其中api接口的格式必须为下面格式：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="string">&quot;text&quot;</span>: <span class="string">&quot;xxx&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: <span class="number">21</span>,</span><br><span class="line">        <span class="string">&quot;text&quot;</span>: <span class="string">&quot;xxx&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>如果选项过多，可通过ajax方式动态分页载入选项：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="string">&#x27;user_id&#x27;</span>)-&gt;<span class="title function_ invoke__">options</span>(function (<span class="variable">$id</span>) &#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title class_">User</span>::<span class="title function_ invoke__">find</span>(<span class="variable">$id</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$user</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$user</span>-&gt;id =&gt; <span class="variable">$user</span>-&gt;name];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)-&gt;<span class="title function_ invoke__">ajax</span>(<span class="string">&#x27;api/users&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>使用model方法在編輯時載入資料：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="string">&#x27;user_id&#x27;</span>)-&gt;<span class="title function_ invoke__">model</span>(<span class="title class_">User</span>::<span class="variable language_">class</span>, <span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;name&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>上面的代碼跟下面這個是一樣的</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="string">&#x27;user_id&#x27;</span>)-&gt;<span class="title function_ invoke__">options</span>(function (<span class="variable">$id</span>) &#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title class_">User</span>::<span class="title function_ invoke__">find</span>(<span class="variable">$id</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$user</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="variable">$user</span>-&gt;id =&gt; <span class="variable">$user</span>-&gt;name];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>


<p>API <code>/admin/api/users</code>接口的代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">users</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$q</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;q&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">User</span>::<span class="title function_ invoke__">where</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;like&#x27;</span>, <span class="string">&quot;%<span class="subst">$q</span>%&quot;</span>)-&gt;<span class="title function_ invoke__">paginate</span>(<span class="literal">null</span>, [<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;name as text&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>接口返回的数据结构为</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;total&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;per_page&quot;</span><span class="punctuation">:</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;current_page&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;last_page&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;next_page_url&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;prev_page_url&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;from&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;to&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">9</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxx&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">21</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxx&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">42</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxx&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">48</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxx&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p><a name="selectload"></a></p>
<h2 id="下拉选框联动-load"><a href="#下拉选框联动-load" class="headerlink" title="下拉选框联动 (load)"></a>下拉选框联动 (load)</h2><p><code>select</code>组件支持父子关系的单向联动：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="string">&#x27;province&#x27;</span>)-&gt;<span class="title function_ invoke__">options</span>(...)-&gt;<span class="title function_ invoke__">load</span>(<span class="string">&#x27;city&#x27;</span>, <span class="string">&#x27;/api/city&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="string">&#x27;city&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>其中<code>load(&#39;city&#39;, &#39;/api/city&#39;);</code>的意思是，在当前select的选项切换之后，会把当前选项的值通过参数<code>q</code>, 调用接口<code>/api/city</code>，并把api返回的数据填充为city选择框的选项，其中api<code>/api/city</code>返回的数据格式必须符合:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="string">&quot;text&quot;</span>: <span class="string">&quot;xxx&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: <span class="number">21</span>,</span><br><span class="line">        <span class="string">&quot;text&quot;</span>: <span class="string">&quot;xxx&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>控制器action的代码示例如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">city</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$provinceId</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;q&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">ChinaArea</span>::<span class="title function_ invoke__">city</span>()-&gt;<span class="title function_ invoke__">where</span>(<span class="string">&#x27;parent_id&#x27;</span>, <span class="variable">$provinceId</span>)-&gt;<span class="title function_ invoke__">get</span>([<span class="string">&#x27;id&#x27;</span>, DB::<span class="title function_ invoke__">raw</span>(<span class="string">&#x27;name as text&#x27;</span>)]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>selectTable</code>、<code>multipleSelectTable</code>、<code>radio</code>、<code>checkbox</code>也可以使用<code>load</code>方法联动<code>select</code>和<code>multipleSelect</code>表单，用法和上面的示例一致。</p>
<h3 id="联动多个字段-loads"><a href="#联动多个字段-loads" class="headerlink" title="联动多个字段 (loads)"></a>联动多个字段 (loads)</h3><p>使用<code>loads</code>方法可以联动多个字段，用法如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="string">&#x27;status&#x27;</span>)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">options</span>(...)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">loads</span>([<span class="string">&#x27;field1&#x27;</span>, <span class="string">&#x27;field2&#x27;</span>], [<span class="string">&#x27;/api/field1&#x27;</span>, <span class="string">&#x27;/api/field2&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="string">&#x27;field1&#x27;</span>);</span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="string">&#x27;field2&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><code>api</code>返回的数据格式与<code>load</code>方法一致，<code>selectTable</code>、<code>multipleSelectTable</code>、<code>radio</code>、<code>checkbox</code>也可以使用<code>loads</code>方法联动。</p>
<p><a name="multipleSelect"></a></p>
<h2 id="下拉选框多选-multipleSelect"><a href="#下拉选框多选-multipleSelect" class="headerlink" title="下拉选框多选 (multipleSelect)"></a>下拉选框多选 (multipleSelect)</h2><blockquote>
<p>{tip} 注入这个字段的数据（从数据库查出来的）可以是一个以<code>,</code>隔开的字符串，也可以是<code>json</code>字符串或<code>array</code>数组。</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleSelect</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])</span><br><span class="line">	-&gt;<span class="title function_ invoke__">options</span>([<span class="number">1</span> =&gt; <span class="string">&#x27;foo&#x27;</span>, <span class="number">2</span> =&gt; <span class="string">&#x27;bar&#x27;</span>, <span class="string">&#x27;val&#x27;</span> =&gt; <span class="string">&#x27;Option name&#x27;</span>])</span><br><span class="line">	-&gt;<span class="title function_ invoke__">saving</span>(function (<span class="variable">$value</span>) &#123;</span><br><span class="line">		<span class="comment">// 转化成json字符串保存到数据库</span></span><br><span class="line">		<span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$value</span>);</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用ajax并显示所选项目：</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleSelect</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">options</span>(<span class="title class_">Model</span>::<span class="variable language_">class</span>)-&gt;<span class="title function_ invoke__">ajax</span>(<span class="string">&#x27;ajax_url&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或指定名称和ID</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleSelect</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">options</span>(<span class="title class_">Model</span>::<span class="variable language_">class</span>, <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;id&#x27;</span>)-&gt;<span class="title function_ invoke__">ajax</span>(<span class="string">&#x27;ajax_url&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>多选框可以处理两种情况，第一种是<code>ManyToMany</code>的关系。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Post</span> <span class="keyword">extends</span> <span class="title">Models</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">tags</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">belongsToMany</span>(<span class="title class_">Tag</span>::<span class="variable language_">class</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title class_">Form</span>::<span class="title function_ invoke__">make</span>(<span class="title class_">Post</span>::<span class="title function_ invoke__">with</span>(<span class="string">&#x27;tags&#x27;</span>), function (Form <span class="variable">$form</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleSelect</span>(<span class="string">&#x27;tags&#x27;</span>)</span><br><span class="line">        -&gt;<span class="title function_ invoke__">options</span>(<span class="title class_">Tag</span>::<span class="title function_ invoke__">all</span>()-&gt;<span class="title function_ invoke__">pluck</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;id&#x27;</span>))</span><br><span class="line">        -&gt;<span class="title function_ invoke__">customFormat</span>(function (<span class="variable">$v</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (! <span class="variable">$v</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> [];</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 从数据库中查出的二维数组中转化成ID</span></span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">array_column</span>(<span class="variable">$v</span>, <span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>第二种是将选项数组存储到单字段中，如果字段是字符串类型，那就需要在模型里面为该字段定义<a target="_blank" rel="noopener" href="https://laravel.com/docs/5.5/eloquent-mutators">访问器和修改器</a>来存储和读取了。</p>
<p>如果选项过多，可通过ajax方式动态分页载入选项：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">select</span>(<span class="string">&#x27;friends&#x27;</span>)-&gt;<span class="title function_ invoke__">options</span>(function (<span class="variable">$ids</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">User</span>::<span class="title function_ invoke__">find</span>(<span class="variable">$ids</span>)-&gt;<span class="title function_ invoke__">pluck</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">&#125;)-&gt;<span class="title function_ invoke__">ajax</span>(<span class="string">&#x27;api/users&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>API <code>/admin/api/users</code>接口的代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">users</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$q</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;q&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">User</span>::<span class="title function_ invoke__">where</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;like&#x27;</span>, <span class="string">&quot;%<span class="subst">$q</span>%&quot;</span>)-&gt;<span class="title function_ invoke__">paginate</span>(<span class="literal">null</span>, [<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;name as text&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>接口返回的数据结构为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;total&quot;: 4,</span><br><span class="line">    &quot;per_page&quot;: 15,</span><br><span class="line">    &quot;current_page&quot;: 1,</span><br><span class="line">    &quot;last_page&quot;: 1,</span><br><span class="line">    &quot;next_page_url&quot;: null,</span><br><span class="line">    &quot;prev_page_url&quot;: null,</span><br><span class="line">    &quot;from&quot;: 1,</span><br><span class="line">    &quot;to&quot;: 3,</span><br><span class="line">    &quot;data&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: 9,</span><br><span class="line">            &quot;text&quot;: &quot;xxx&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: 21,</span><br><span class="line">            &quot;text&quot;: &quot;xxx&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: 42,</span><br><span class="line">            &quot;text&quot;: &quot;xxx&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: 48,</span><br><span class="line">            &quot;text&quot;: &quot;xxx&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a name="select-table"></a></p>
<h2 id="表格选择器-selectTable"><a href="#表格选择器-selectTable" class="headerlink" title="表格选择器 (selectTable)"></a>表格选择器 (selectTable)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Admin</span>\<span class="title">Renderable</span>\<span class="title">UserTable</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Models</span>\<span class="title">Administrator</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">selectTable</span>(<span class="variable">$field</span>)</span><br><span class="line">	-&gt;<span class="title function_ invoke__">title</span>(<span class="string">&#x27;弹窗标题&#x27;</span>)</span><br><span class="line">	-&gt;<span class="title function_ invoke__">dialogWidth</span>(<span class="string">&#x27;50%&#x27;</span>) <span class="comment">// 弹窗宽度，默认 800px</span></span><br><span class="line">	-&gt;<span class="keyword">from</span>(<span class="title class_">UserTable</span>::<span class="title function_ invoke__">make</span>([<span class="string">&#x27;id&#x27;</span> =&gt; <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">getKey</span>()])) <span class="comment">// 设置渲染类实例，并传递自定义参数</span></span><br><span class="line">	-&gt;<span class="title function_ invoke__">model</span>(<span class="title class_">Administrator</span>::<span class="variable language_">class</span>, <span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;name&#x27;</span>); <span class="comment">// 设置编辑数据显示</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">// 上面的代码等同于</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">selectTable</span>(<span class="variable">$field</span>)</span><br><span class="line">	-&gt;<span class="keyword">from</span>(<span class="title class_">UserTable</span>::<span class="title function_ invoke__">make</span>([<span class="string">&#x27;id&#x27;</span> =&gt; <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">getKey</span>()])) <span class="comment">// 设置渲染类实例，并传递自定义参数</span></span><br><span class="line">	-&gt;<span class="title function_ invoke__">options</span>(function (<span class="variable">$v</span>) &#123; <span class="comment">// 设置编辑数据显示</span></span><br><span class="line">		<span class="keyword">if</span> (! <span class="variable">$v</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> [];</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="title class_">Administrator</span>::<span class="title function_ invoke__">find</span>(<span class="variable">$v</span>)-&gt;<span class="title function_ invoke__">pluck</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>

<p>定义渲染类如下，需要继承<code>Dcat\Admin\Grid\LazyRenderable</code></p>
<blockquote>
<p>{tip} 这里使用了数据表格异步加载功能，详细用法请参考<a href="lazy.md">异步加载</a></p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Admin</span>\<span class="title class_">Renderable</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Grid</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Grid</span>\<span class="title">LazyRenderable</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Models</span>\<span class="title">Administrator</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserTable</span> <span class="keyword">extends</span> <span class="title">LazyRenderable</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">grid</span>(<span class="params"></span>): <span class="title">Grid</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// 获取外部传递的参数</span></span><br><span class="line">        <span class="variable">$id</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Grid</span>::<span class="title function_ invoke__">make</span>(<span class="title class_">Administrator</span>::<span class="title function_ invoke__">where</span>(<span class="string">&#x27;xxx_id&#x27;</span>, <span class="variable">$id</span>), function (Grid <span class="variable">$grid</span>) &#123;</span><br><span class="line">            <span class="variable">$grid</span>-&gt;<span class="title function_ invoke__">column</span>(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">            <span class="variable">$grid</span>-&gt;<span class="title function_ invoke__">column</span>(<span class="string">&#x27;username&#x27;</span>);</span><br><span class="line">            <span class="variable">$grid</span>-&gt;<span class="title function_ invoke__">column</span>(<span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">            <span class="variable">$grid</span>-&gt;<span class="title function_ invoke__">column</span>(<span class="string">&#x27;created_at&#x27;</span>);</span><br><span class="line">            <span class="variable">$grid</span>-&gt;<span class="title function_ invoke__">column</span>(<span class="string">&#x27;updated_at&#x27;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="variable">$grid</span>-&gt;<span class="title function_ invoke__">quickSearch</span>([<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="variable">$grid</span>-&gt;<span class="title function_ invoke__">paginate</span>(<span class="number">10</span>);</span><br><span class="line">            <span class="variable">$grid</span>-&gt;<span class="title function_ invoke__">disableActions</span>();</span><br><span class="line"></span><br><span class="line">            <span class="variable">$grid</span>-&gt;<span class="title function_ invoke__">filter</span>(function (Grid\Filter <span class="variable">$filter</span>) &#123;</span><br><span class="line">                <span class="variable">$filter</span>-&gt;<span class="title function_ invoke__">like</span>(<span class="string">&#x27;username&#x27;</span>)-&gt;<span class="title function_ invoke__">width</span>(<span class="number">4</span>);</span><br><span class="line">                <span class="variable">$filter</span>-&gt;<span class="title function_ invoke__">like</span>(<span class="string">&#x27;name&#x27;</span>)-&gt;<span class="title function_ invoke__">width</span>(<span class="number">4</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>效果</p>
<a href="https://cdn.learnku.com/uploads/images/202008/23/38389/P5hZXiqAj9.gif!large" target="_blank">
![](https://cdn.learnku.com/uploads/images/202008/23/38389/P5hZXiqAj9.gif!large)
</a>

<h3 id="设置选中后将保存到表单的字段和显示的字段"><a href="#设置选中后将保存到表单的字段和显示的字段" class="headerlink" title="设置选中后将保存到表单的字段和显示的字段"></a>设置选中后将保存到表单的字段和显示的字段</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">selectTable</span>(<span class="variable">$field</span>)</span><br><span class="line">	-&gt;<span class="keyword">from</span>(<span class="title class_">UserTable</span>::<span class="title function_ invoke__">make</span>([<span class="string">&#x27;id&#x27;</span> =&gt; <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">getKey</span>()]))</span><br><span class="line">	-&gt;<span class="title function_ invoke__">options</span>(function (<span class="variable">$v</span>) &#123; <span class="comment">// 设置编辑数据显示</span></span><br><span class="line">		<span class="keyword">if</span> (! <span class="variable">$v</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> [];</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="title class_">Administrator</span>::<span class="title function_ invoke__">find</span>(<span class="variable">$v</span>)-&gt;<span class="title function_ invoke__">pluck</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">	&#125;)</span><br><span class="line">	-&gt;<span class="title function_ invoke__">pluck</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;id&#x27;</span>); <span class="comment">// 第一个参数为显示的字段，第二个参数为选中后将保存到表单的字段</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">// 上面的代码也可以简化为</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">selectTable</span>(<span class="variable">$field</span>)</span><br><span class="line">	-&gt;<span class="keyword">from</span>(<span class="title class_">UserTable</span>::<span class="title function_ invoke__">make</span>([<span class="string">&#x27;id&#x27;</span> =&gt; <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">getKey</span>()]))</span><br><span class="line">	-&gt;<span class="title function_ invoke__">model</span>(<span class="title class_">Administrator</span>::<span class="variable language_">class</span>, <span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;name&#x27;</span>); <span class="comment">// 设置编辑数据显示</span></span><br></pre></td></tr></table></figure>



<h3 id="多选-multipleSelectTable"><a href="#多选-multipleSelectTable" class="headerlink" title="多选 (multipleSelectTable)"></a>多选 (multipleSelectTable)</h3><p>多选的用法与上述<code>selectTable</code>方法一致</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleSelectTable</span>(<span class="variable">$field</span>)</span><br><span class="line">	-&gt;<span class="title function_ invoke__">max</span>(<span class="number">10</span>) <span class="comment">// 最多选择 10 个选项，不传则不限制</span></span><br><span class="line">	-&gt;<span class="keyword">from</span>(<span class="title class_">UserTable</span>::<span class="title function_ invoke__">make</span>([<span class="string">&#x27;id&#x27;</span> =&gt; <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">getKey</span>()])) <span class="comment">// 设置渲染类实例，并传递自定义参数</span></span><br><span class="line">	-&gt;<span class="title function_ invoke__">model</span>(<span class="title class_">Administrator</span>::<span class="variable language_">class</span>, <span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;name&#x27;</span>)  <span class="comment">// 设置编辑数据显示</span></span><br><span class="line">	-&gt;<span class="title function_ invoke__">saving</span>(function (<span class="variable">$v</span>) &#123;</span><br><span class="line">		<span class="comment">// $v 是表单提交的字段值，默认是数组类型，这里需要手动转换一下</span></span><br><span class="line">		<span class="comment">// 保存为以 &quot;,&quot; 隔开的字符串，如果是多对多关联关系，则不需要转换。</span></span><br><span class="line">		<span class="keyword">return</span> <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$v</span>);</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>


<h2 id="多选盒-listbox"><a href="#多选盒-listbox" class="headerlink" title="多选盒 (listbox)"></a>多选盒 (listbox)</h2><p>使用方法和<code>multipleSelect</code>类似。</p>
<blockquote>
<p>{tip} 注入这个字段的数据（从数据库查出来的）可以是一个以<code>,</code>隔开的字符串，也可以是<code>json</code>字符串或<code>array</code>数组。</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">listbox</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">options</span>([<span class="number">1</span> =&gt; <span class="string">&#x27;foo&#x27;</span>, <span class="number">2</span> =&gt; <span class="string">&#x27;bar&#x27;</span>, <span class="string">&#x27;val&#x27;</span> =&gt; <span class="string">&#x27;Option name&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p><a name="textarea"></a></p>
<h2 id="长文本-textarea"><a href="#长文本-textarea" class="headerlink" title="长文本 (textarea)"></a>长文本 (textarea)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">textarea</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">rows</span>(<span class="number">10</span>);</span><br></pre></td></tr></table></figure>

<p><a name="radio"></a></p>
<h2 id="单选-radio"><a href="#单选-radio" class="headerlink" title="单选 (radio)"></a>单选 (radio)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">radio</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">options</span>([<span class="string">&#x27;m&#x27;</span> =&gt; <span class="string">&#x27;Female&#x27;</span>, <span class="string">&#x27;f&#x27;</span>=&gt; <span class="string">&#x27;Male&#x27;</span>])-&gt;<span class="keyword">default</span>(<span class="string">&#x27;m&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="checkbox"></a></p>
<h2 id="多选-checkbox"><a href="#多选-checkbox" class="headerlink" title="多选 (checkbox)"></a>多选 (checkbox)</h2><p><code>options()</code>方法用来设置选择项:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">checkbox</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])</span><br><span class="line">	-&gt;<span class="title function_ invoke__">options</span>([<span class="number">1</span> =&gt; <span class="string">&#x27;foo&#x27;</span>, <span class="number">2</span> =&gt; <span class="string">&#x27;bar&#x27;</span>, <span class="string">&#x27;val&#x27;</span> =&gt; <span class="string">&#x27;Option name&#x27;</span>])</span><br><span class="line">	-&gt;<span class="title function_ invoke__">saving</span>(function (<span class="variable">$value</span>) &#123;</span><br><span class="line">		<span class="comment">// 转化成json字符串保存到数据库</span></span><br><span class="line">		<span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$value</span>);</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>


<p>启用选中全部功能</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">checkbox</span>(<span class="string">&#x27;column&#x27;</span>)-&gt;<span class="title function_ invoke__">canCheckAll</span>();</span><br></pre></td></tr></table></figure>

<p><a name="autocomplete"></a></p>
<h2 id="autocomplete"><a href="#autocomplete" class="headerlink" title="autocomplete"></a>autocomplete</h2><p>此表单可以在填写表单时进行对表单值进行搜索，并把结果展示在下拉列表中，用法如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">autocomplete</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">options</span>([<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>, ...]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置分组名称</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">autocomplete</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">groups</span>([</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&#x27;label&#x27;</span> =&gt; <span class="string">&#x27;group name&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;options&#x27;</span> =&gt; [<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>, ...],</span><br><span class="line">    ],</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>

<p>效果如下<br><img src="https://cdn.learnku.com/uploads/images/202112/12/38389/ArVNSvChag.png!large"></p>
<h3 id="从远程API获取数据"><a href="#从远程API获取数据" class="headerlink" title="从远程API获取数据"></a>从远程API获取数据</h3><p>也可以从远程API中获取数据</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ajax 函数的第一个参数为 ajax url, 第二个参数为 valueField（可选）, 第三个参数为 groupField（可选）</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">autocomplete</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">ajax</span>(<span class="string">&#x27;/countries&#x27;</span>, <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;region&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>远程API 服务端的请求参数为query，示例代码如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CountryController</span> <span class="keyword">extends</span> <span class="title">AdminController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">search</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$countries</span> = <span class="title class_">Country</span>::<span class="title function_ invoke__">when</span>(<span class="title function_ invoke__">request</span>(<span class="string">&#x27;query&#x27;</span>), function (<span class="variable">$query</span>, <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="variable">$query</span>-&gt;<span class="title function_ invoke__">where</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;like&#x27;</span>, <span class="string">&quot;%<span class="subst">&#123;$value&#125;</span>%&quot;</span>);</span><br><span class="line">        &#125;)-&gt;<span class="title function_ invoke__">get</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Admin</span>::<span class="title function_ invoke__">json</span>(<span class="variable">$countries</span>-&gt;<span class="title function_ invoke__">toArray</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="自定义-autocomplete-的设置："><a href="#自定义-autocomplete-的设置：" class="headerlink" title="自定义 autocomplete 的设置："></a>自定义 autocomplete 的设置：</h3><p>详细设置请参考： <a target="_blank" rel="noopener" href="https://github.com/devbridge/jQuery-Autocomplete">devbridge&#x2F;jQuery-Autocomplete</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$js = &lt;&lt;&lt;JS</span><br><span class="line">    function (suggestion) &#123;</span><br><span class="line">        alert(&#x27;You selected: &#x27; + suggestion.value + &#x27;, &#x27; + suggestion.data);</span><br><span class="line">    &#125;</span><br><span class="line">JS;</span><br><span class="line"></span><br><span class="line">$form-&gt;autocomplete($column[, $label])-&gt;configs([</span><br><span class="line">    &#x27;minChars&#x27; =&gt; 5,</span><br><span class="line">    &#x27;noCache&#x27; =&gt; true,</span><br><span class="line">    &#x27;onSelect&#x27; =&gt; JavaScript::make($js),</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>

<p>configs 同样也支持闭包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$form-&gt;autocomplete($column[, $label])-&gt;configs(function($model, $value)&#123;</span><br><span class="line">    return [</span><br><span class="line">        ....</span><br><span class="line">    ];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="表单联动"><a href="#表单联动" class="headerlink" title="表单联动"></a>表单联动</h3><p>autocomplete 的联动逻辑和select的刚好相反。<br>depends 需要写在受影响的字段，不限上级字段类型，上级字段的值将同时上传到API。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$form-&gt;select(&#x27;region&#x27;)-&gt;options([</span><br><span class="line">    &#x27;asia&#x27;,</span><br><span class="line">    &#x27;Africa&#x27;,</span><br><span class="line">    &#x27;America&#x27;,</span><br><span class="line">    &#x27;Europe&#x27;,</span><br><span class="line">]);</span><br><span class="line"></span><br><span class="line">$form-&gt;autocomplete(&#x27;country&#x27;)-&gt;ajax(&#x27;/countries&#x27;, &#x27;name&#x27;, &#x27;region&#x27;);</span><br><span class="line"></span><br><span class="line">// 将会发出 /states?query=&#123;query&#125;&amp;region=&#123;region&#125;&amp;country=&#123;country&#125;  的请求</span><br><span class="line">$form-&gt;autocomplete(&#x27;addr&#x27;)-&gt;ajax(&#x27;/states&#x27;, &#x27;name&#x27;)-&gt;depends([&#x27;region&#x27;, &#x27;country&#x27;]);</span><br></pre></td></tr></table></figure>


<p><a name="email"></a></p>
<h2 id="邮箱-email"><a href="#邮箱-email" class="headerlink" title="邮箱 (email)"></a>邮箱 (email)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">email</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br></pre></td></tr></table></figure>

<p><a name="password"></a></p>
<h2 id="密码-password"><a href="#密码-password" class="headerlink" title="密码 (password)"></a>密码 (password)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">password</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br></pre></td></tr></table></figure>

<p><a name="url"></a></p>
<h2 id="链接-url"><a href="#链接-url" class="headerlink" title="链接 (url)"></a>链接 (url)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">url</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br></pre></td></tr></table></figure>

<p><a name="ip"></a></p>
<h2 id="IP地址-ip"><a href="#IP地址-ip" class="headerlink" title="IP地址 (ip)"></a>IP地址 (ip)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">ip</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br></pre></td></tr></table></figure>

<p><a name="mobile"></a></p>
<h2 id="手机-mobile"><a href="#手机-mobile" class="headerlink" title="手机 (mobile)"></a>手机 (mobile)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">mobile</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">options</span>([<span class="string">&#x27;mask&#x27;</span> =&gt; <span class="string">&#x27;999 9999 9999&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p><a name="color"></a></p>
<h2 id="颜色选择器-color"><a href="#颜色选择器-color" class="headerlink" title="颜色选择器 (color)"></a>颜色选择器 (color)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">color</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br></pre></td></tr></table></figure>

<p><a name="time"></a></p>
<h2 id="时间-time"><a href="#时间-time" class="headerlink" title="时间 (time)"></a>时间 (time)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">time</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置时间格式，更多格式参考http://momentjs.com/docs/#/displaying/format/</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">time</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">format</span>(<span class="string">&#x27;HH:mm:ss&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="date"></a></p>
<h2 id="日期-date"><a href="#日期-date" class="headerlink" title="日期 (date)"></a>日期 (date)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">date</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置日期格式，更多格式参考http://momentjs.com/docs/#/displaying/format/</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">date</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">format</span>(<span class="string">&#x27;YYYY-MM-DD&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="datetime"></a></p>
<h2 id="时间日期-datetime"><a href="#时间日期-datetime" class="headerlink" title="时间日期 (datetime)"></a>时间日期 (datetime)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">datetime</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置日期格式，更多格式参考http://momentjs.com/docs/#/displaying/format/</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">datetime</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">format</span>(<span class="string">&#x27;YYYY-MM-DD HH:mm:ss&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="timeRange"></a></p>
<h2 id="时间范围-timeRange"><a href="#时间范围-timeRange" class="headerlink" title="时间范围 (timeRange)"></a>时间范围 (timeRange)</h2><p><code>$startTime</code>、<code>$endTime</code>为开始和结束时间字段:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">timeRange</span>(<span class="variable">$startTime</span>, <span class="variable">$endTime</span>, <span class="string">&#x27;Time Range&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="dateRange"></a></p>
<h2 id="日期范围-dateRange"><a href="#日期范围-dateRange" class="headerlink" title="日期范围 (dateRange)"></a>日期范围 (dateRange)</h2><p><code>$startDate</code>、<code>$endDate</code>为开始和结束日期字段:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">dateRange</span>(<span class="variable">$startDate</span>, <span class="variable">$endDate</span>, <span class="string">&#x27;Date Range&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="datetimeRange"></a></p>
<h2 id="时间日期范围-datetimeRange"><a href="#时间日期范围-datetimeRange" class="headerlink" title="时间日期范围 (datetimeRange)"></a>时间日期范围 (datetimeRange)</h2><p><code>$startDateTime</code>、<code>$endDateTime</code>为开始和结束时间日期:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">datetimeRange</span>(<span class="variable">$startDateTime</span>, <span class="variable">$endDateTime</span>, <span class="string">&#x27;DateTime Range&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="范围-range"><a href="#范围-range" class="headerlink" title="范围 (range)"></a>范围 (range)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">range</span>(<span class="string">&#x27;start_column&#x27;</span>, <span class="string">&#x27;end_column&#x27;</span>, <span class="string">&#x27;范围&#x27;</span>);</span><br></pre></td></tr></table></figure>


<p><a name="file"></a></p>
<h2 id="文件上传-file"><a href="#文件上传-file" class="headerlink" title="文件上传 (file)"></a>文件上传 (file)</h2><p>使用文件上传功能之前需要先完成上传配置。文件上传配置以及内置方法请参考:<a href="model-form-upload.md">图片&#x2F;文件上传</a>.</p>
<p>文件上传目录在文件<code>config/admin.php</code>中的<code>upload.file</code>中配置，如果目录不存在，需要创建该目录并开放写权限。</p>
<blockquote>
<p>{tip} 文件或图片上传表单字段请不要在模型中设置<strong>访问器</strong>和<strong>修改器</strong>拼接域名，如有相关需求可参考<a href="model-form-upload.md#withhost">文件&#x2F;图片域名拼接</a>。</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">file</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改文件上传路径和文件名</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">file</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">move</span>(<span class="variable">$dir</span>, <span class="variable">$name</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 并设置上传文件类型</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">file</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">rules</span>(<span class="string">&#x27;mimes:doc,docx,xlsx&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加文件删除按钮</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">file</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">removable</span>();</span><br></pre></td></tr></table></figure>

<p><a name="image"></a></p>
<h2 id="图片上传-image"><a href="#图片上传-image" class="headerlink" title="图片上传 (image)"></a>图片上传 (image)</h2><p>使用图片上传功能之前需要先完成上传配置。图片上传配置以及内置方法请参考:<a href="model-form-upload.md">图片&#x2F;文件上传</a>.</p>
<p>图片上传目录在文件<code>config/admin.php</code>中的<code>upload.image</code>中配置，如果目录不存在，需要创建该目录并开放写权限。</p>
<p>可以使用压缩、裁切、添加水印等各种方法,需要先安装<a target="_blank" rel="noopener" href="http://image.intervention.io/getting_started/installation">intervention&#x2F;image</a>。</p>
<p>更多使用方法请参考[<a target="_blank" rel="noopener" href="http://image.intervention.io/getting_started/introduction">Intervention</a>]：</p>
<blockquote>
<p>{tip} 文件或图片上传表单字段请不要在模型中设置<strong>访问器</strong>和<strong>修改器</strong>拼接域名，如有相关需求可参考<a href="model-form-upload.md#withhost">文件&#x2F;图片域名拼接</a>。</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">image</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改图片上传路径和文件名</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">image</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">move</span>(<span class="variable">$dir</span>, <span class="variable">$name</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 剪裁图片</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">image</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">crop</span>(<span class="keyword">int</span> <span class="variable">$width</span>, <span class="keyword">int</span> <span class="variable">$height</span>, [<span class="keyword">int</span> <span class="variable">$x</span>, <span class="keyword">int</span> <span class="variable">$y</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加水印</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">image</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">insert</span>(<span class="variable">$watermark</span>, <span class="string">&#x27;center&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="multipleImage"></a></p>
<h2 id="多图和多文件上传-multipleImage-multipleFile"><a href="#多图和多文件上传-multipleImage-multipleFile" class="headerlink" title="多图和多文件上传 (multipleImage&#x2F;multipleFile)"></a>多图和多文件上传 (multipleImage&#x2F;multipleFile)</h2><p>多图片上传表单继承自单图上传表单，多文件上传表单继承自单文件上传表单。</p>
<blockquote>
<p>{tip} 注入这个字段的数据（从数据库查出来的）可以是一个以<code>,</code>隔开的字符串，也可以是<code>json</code>字符串或<code>array</code>数组。</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 多图</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleImage</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 限制最大上传数量</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleImage</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">limit</span>(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 多文件</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleFile</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 限制最大上传数量</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleFile</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">limit</span>(<span class="number">5</span>);</span><br></pre></td></tr></table></figure>

<p>多图&#x2F;文件上传的时候提交的数据是一个<code>array</code>数组，你可以通过以下方式把数据在保存进数据库之前改为你想要的格式：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 转化为json格式保存到数据库</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleFile</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">saving</span>(function (<span class="variable">$paths</span>) &#123;</span><br><span class="line">    <span class="comment">// 可以转化为由 , 隔开的字符串格式</span></span><br><span class="line">    <span class="comment">// return implode(&#x27;,&#x27;, $paths);</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 也可以转化为json</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$paths</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>当然，如果你想保存为其他任意格式都是可以的，只是如果要保存其他格式，需要通过用<code>customFormat</code>方法把数据转化为一维数组展示，如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleFile</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])</span><br><span class="line">    -&gt;<span class="title function_ invoke__">customFormat</span>(function (<span class="variable">$paths</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">collect</span>(<span class="variable">$paths</span>)-&gt;<span class="title function_ invoke__">map</span>(function (<span class="variable">$value</span>) &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$value</span>);</span><br><span class="line">        &#125;)-&gt;<span class="title function_ invoke__">flatten</span>()-&gt;<span class="title function_ invoke__">toArray</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">saving</span>(function (<span class="variable">$paths</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">implode</span>(<span class="string">&#x27;|&#x27;</span>, <span class="variable">$paths</span>);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>


<p>启用可排序功能</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">multipleImage</span>(<span class="string">&#x27;images&#x27;</span>)-&gt;<span class="title function_ invoke__">sortable</span>();</span><br></pre></td></tr></table></figure>


<p><a name="editor"></a></p>
<h2 id="富文本编辑器-editor"><a href="#富文本编辑器-editor" class="headerlink" title="富文本编辑器 (editor)"></a>富文本编辑器 (editor)</h2><p>系统集成了<code>TinyMCE</code>编辑器作为内置编辑器。</p>
<h4 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">editor</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br></pre></td></tr></table></figure>

<h4 id="设置语言包"><a href="#设置语言包" class="headerlink" title="设置语言包"></a>设置语言包</h4><p>默认支持简体中文和英文两种语言，如需其他语言可以通过以下方式设置语言包地址。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">editor</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">languageUrl</span>(<span class="title function_ invoke__">url</span>(<span class="string">&#x27;TinyMCE/langs/de.js&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h4 id="编辑器配置"><a href="#编辑器配置" class="headerlink" title="编辑器配置"></a>编辑器配置</h4><p>具体配置等的使用可以参考<a target="_blank" rel="noopener" href="https://www.tiny.cloud/docs">官方文档</a>或<a target="_blank" rel="noopener" href="http://tinymce.ax-z.cn/">中文文档</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Support</span>\<span class="title">JavaScript</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">editor</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">options</span>([</span><br><span class="line">    <span class="string">&#x27;toolbar&#x27;</span> =&gt; [],</span><br><span class="line">    <span class="string">&#x27;setup&#x27;</span> =&gt; <span class="title class_">JavaScript</span>::<span class="title function_ invoke__">make</span>(</span><br><span class="line">        <span class="string">&lt;&lt;&lt;JS</span></span><br><span class="line"><span class="string">function (editor) &#123;</span></span><br><span class="line"><span class="string">    console.log(&#x27;编辑器初始化成功&#x27;, editor)</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">JS</span></span><br><span class="line">    ),</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>

<h4 id="设置高度"><a href="#设置高度" class="headerlink" title="设置高度"></a>设置高度</h4><p>默认值为<code>400</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">editor</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">height</span>(<span class="string">&#x27;600&#x27;</span>);</span><br></pre></td></tr></table></figure>


<h4 id="只读"><a href="#只读" class="headerlink" title="只读"></a>只读</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">editor</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">readOnly</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">editor</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">disable</span>();</span><br></pre></td></tr></table></figure>

<h4 id="图片上传"><a href="#图片上传" class="headerlink" title="图片上传"></a>图片上传</h4><p>设置图片上传<code>disk</code>配置，默认上传到<code>admin.upload.disk</code>指定的配置</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 上传到oss</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">editor</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">disk</span>(<span class="string">&#x27;oss&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>设置图片上传目录，默认为<code>tinymce/images</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">editor</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">imageDirectory</span>(<span class="string">&#x27;editor/images&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>自定义上传接口，接口返回格式需要是<code>&#123;&quot;location&quot;: &quot;图片url&quot;&#125;</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">editor</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">imageUrl</span>(<span class="string">&#x27;editor/upload-image&#x27;</span>);</span><br></pre></td></tr></table></figure>


<h4 id="全局设置"><a href="#全局设置" class="headerlink" title="全局设置"></a>全局设置</h4><p>如果你需要对编辑器进行全局设置，可以在<code>app\Admin\bootstrap.php</code>加上以下代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Form</span>\<span class="title">Field</span>\<span class="title">Editor</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Editor</span>::<span class="title function_ invoke__">resolving</span>(function (Editor <span class="variable">$editor</span>) &#123;</span><br><span class="line">    <span class="comment">// 设置默认配置</span></span><br><span class="line">    <span class="variable">$editor</span>-&gt;<span class="title function_ invoke__">options</span>([...]);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 设置编辑器图片默认上传到七牛云</span></span><br><span class="line">    <span class="variable">$editor</span>-&gt;<span class="title function_ invoke__">disk</span>(<span class="string">&#x27;qiniu&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<p><a name="markdown"></a></p>
<h2 id="Markdown编辑器-markdown"><a href="#Markdown编辑器-markdown" class="headerlink" title="Markdown编辑器 (markdown)"></a>Markdown编辑器 (markdown)</h2><p>系统集成了<code>editor-md</code>编辑器作为内置Markdown编辑器。</p>
<h4 id="基本使用-1"><a href="#基本使用-1" class="headerlink" title="基本使用"></a>基本使用</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">markdown</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br></pre></td></tr></table></figure>

<h4 id="设置语言包-1"><a href="#设置语言包-1" class="headerlink" title="设置语言包"></a>设置语言包</h4><p>默认支持简体中文和英文两种语言，如需其他语言可以通过以下方式设置语言包地址。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">markdown</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">languageUrl</span>(<span class="title function_ invoke__">admin_asset</span>(<span class="string">&#x27;@admin/dcat/plugins/editor-md/languages/zh-tw.js&#x27;</span>));</span><br></pre></td></tr></table></figure>

<h4 id="编辑器配置-1"><a href="#编辑器配置-1" class="headerlink" title="编辑器配置"></a>编辑器配置</h4><p>具体配置等的使用可以参考<a target="_blank" rel="noopener" href="https://pandao.github.io/editor.md/">官方文档</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Support</span>\<span class="title">JavaScript</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">markdown</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">options</span>([</span><br><span class="line">    <span class="string">&#x27;onpreviewing&#x27;</span> =&gt; <span class="title class_">JavaScript</span>::<span class="title function_ invoke__">make</span>(</span><br><span class="line">        <span class="string">&lt;&lt;&lt;JS</span></span><br><span class="line"><span class="string">function() &#123;</span></span><br><span class="line"><span class="string">	// console.log(&quot;onpreviewing =&gt;&quot;, this, this.id, this.settings);</span></span><br><span class="line"><span class="string">	// on previewing you can custom css .editormd-preview-active</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">JS</span></span><br><span class="line">    ),</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>

<h4 id="设置高度-1"><a href="#设置高度-1" class="headerlink" title="设置高度"></a>设置高度</h4><p>默认值为<code>500</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">markdown</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">height</span>(<span class="string">&#x27;600&#x27;</span>);</span><br></pre></td></tr></table></figure>


<h4 id="只读-1"><a href="#只读-1" class="headerlink" title="只读"></a>只读</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">markdown</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">readOnly</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">markdown</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">disable</span>();</span><br></pre></td></tr></table></figure>


<h4 id="图片上传-1"><a href="#图片上传-1" class="headerlink" title="图片上传"></a>图片上传</h4><p>设置图片上传<code>disk</code>配置，默认上传到<code>admin.upload.disk</code>指定的配置</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 上传到oss</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">markdown</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">disk</span>(<span class="string">&#x27;oss&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>设置图片上传目录，默认为<code>markdown/images</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">markdown</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">imageDirectory</span>(<span class="string">&#x27;markdown/images&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>自定义上传接口，接口返回格式需要是<code>&#123;&quot;success&quot;: 1, &quot;url&quot;: &quot;图片url&quot;&#125;</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">markdown</span>(<span class="string">&#x27;content&#x27;</span>)-&gt;<span class="title function_ invoke__">imageUrl</span>(<span class="string">&#x27;markdown/upload-image&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="全局设置-1"><a href="#全局设置-1" class="headerlink" title="全局设置"></a>全局设置</h4><p>如果你需要对编辑器进行全局设置，可以在<code>app\Admin\bootstrap.php</code>加上以下代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Form</span>\<span class="title">Field</span>\<span class="title">Markdown</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Markdown</span>::<span class="title function_ invoke__">resolving</span>(function (Markdown <span class="variable">$markdown</span>) &#123;</span><br><span class="line">    <span class="comment">// 设置默认配置</span></span><br><span class="line">    <span class="variable">$markdown</span>-&gt;<span class="title function_ invoke__">options</span>([...]);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 设置编辑器图片默认上传到七牛云</span></span><br><span class="line">    <span class="variable">$markdown</span>-&gt;<span class="title function_ invoke__">disk</span>(<span class="string">&#x27;qiniu&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><a name="switch"></a></p>
<h2 id="开关-switch"><a href="#开关-switch" class="headerlink" title="开关 (switch)"></a>开关 (switch)</h2><p>使用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="keyword">switch</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br></pre></td></tr></table></figure>

<p>开关表单保存到数据库的默认值为<code>1</code>和<code>0</code>，如果需要更改保存到数据库的值，可以这样使用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="keyword">switch</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])</span><br><span class="line">	-&gt;<span class="title function_ invoke__">customFormat</span>(function (<span class="variable">$v</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$v</span> == <span class="string">&#x27;打开&#x27;</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">	&#125;)</span><br><span class="line">	-&gt;<span class="title function_ invoke__">saving</span>(function (<span class="variable">$v</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$v</span> ? <span class="string">&#x27;打开&#x27;</span> : <span class="string">&#x27;关闭&#x27;</span>;</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>


<p><a name="map"></a></p>
<h2 id="地图-map"><a href="#地图-map" class="headerlink" title="地图 (map)"></a>地图 (map)</h2><p>地图控件，用来选择经纬度,<code>$latitude</code>, <code>$longitude</code>为经纬度字段。</p>
<p>使用这个功能需要在 <code>config/admin.php</code> 文件中修改 <code>map_provider</code> 的值（目前支持的地图为：”tencent”, “google”, “yandex”，不同地图需要自己申请相应的 KEY 并在 .env 文件中配置，然后需要在<code>app/Admin/bootstrap.php</code>中加入以下代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Form\Field\Map</span>::<span class="title function_ invoke__">requireAssets</span>();</span><br></pre></td></tr></table></figure>

<p>使用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">map</span>(<span class="variable">$latitude</span>, <span class="variable">$longitude</span>, <span class="variable">$label</span>);</span><br></pre></td></tr></table></figure>


<p><a name="slider"></a></p>
<h2 id="滑动条-slider"><a href="#滑动条-slider" class="headerlink" title="滑动条 (slider)"></a>滑动条 (slider)</h2><p>可以用来数字类型字段的选择，比如年龄：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">slider</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">options</span>([<span class="string">&#x27;max&#x27;</span> =&gt; <span class="number">100</span>, <span class="string">&#x27;min&#x27;</span> =&gt; <span class="number">1</span>, <span class="string">&#x27;step&#x27;</span> =&gt; <span class="number">1</span>, <span class="string">&#x27;postfix&#x27;</span> =&gt; <span class="string">&#x27;years old&#x27;</span>]);</span><br></pre></td></tr></table></figure>
<p>更多options请参考:<a target="_blank" rel="noopener" href="https://github.com/IonDen/ion.rangeSlider#settings">https://github.com/IonDen/ion.rangeSlider#settings</a></p>
<p><a name="display"></a></p>
<h2 id="仅显示-display"><a href="#仅显示-display" class="headerlink" title="仅显示 (display)"></a>仅显示 (display)</h2><p>只显示字段，不做任何操作：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//更复杂的显示</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">with</span>(function (<span class="variable">$value</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&lt;img src=&quot;</span><span class="variable">$value</span><span class="string">&quot; /&gt;&quot;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>


<p><a name="currency"></a></p>
<h2 id="单位符号-currency"><a href="#单位符号-currency" class="headerlink" title="单位符号 (currency)"></a>单位符号 (currency)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">currency</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置单位符号</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">currency</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>])-&gt;<span class="title function_ invoke__">symbol</span>(<span class="string">&#x27;￥&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="number"></a></p>
<h2 id="数字-number"><a href="#数字-number" class="headerlink" title="数字 (number)"></a>数字 (number)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">number</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br></pre></td></tr></table></figure>

<p><a name="rate"></a></p>
<h2 id="费率-rate"><a href="#费率-rate" class="headerlink" title="费率 (rate)"></a>费率 (rate)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">rate</span>(<span class="variable">$column</span>[, <span class="variable">$label</span>]);</span><br></pre></td></tr></table></figure>

<p><a name="divider"></a></p>
<h2 id="分割线-divider"><a href="#分割线-divider" class="headerlink" title="分割线 (divider)"></a>分割线 (divider)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">divider</span>();</span><br></pre></td></tr></table></figure>

<p><a name="html"></a></p>
<h2 id="自定义内容-html"><a href="#自定义内容-html" class="headerlink" title="自定义内容 (html)"></a>自定义内容 (html)</h2><p>插入html内容，参数可以是实现了<code>Htmlable</code>、<code>Renderable</code>或者实现了<code>__toString()</code>方法的类</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">html</span>(<span class="string">&#x27;你的html内容&#x27;</span>, <span class="variable">$label</span> = <span class="string">&#x27;&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="tags"></a></p>
<h2 id="标签-tags"><a href="#标签-tags" class="headerlink" title="标签 (tags)"></a>标签 (tags)</h2><p>插入逗号(,)隔开的字符串<code>tags</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">tags</span>(<span class="string">&#x27;keywords&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><code>tags</code>同样支持<code>ManyToMany</code>的关系，示例如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">tags</span>(<span class="string">&#x27;tags&#x27;</span>, <span class="string">&#x27;文章标签&#x27;</span>)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">pluck</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;id&#x27;</span>) <span class="comment">// name 为需要显示的 Tag 模型的字段，id 为主键</span></span><br><span class="line">    -&gt;<span class="title function_ invoke__">options</span>(<span class="title class_">Tag</span>::<span class="title function_ invoke__">all</span>());<span class="comment">// 下拉框选项</span></span><br></pre></td></tr></table></figure>

<p>注意：处理<code>ManyToMany</code>关系时必须调用<code>pluck</code>方法，指定显示的字段名和主键。<br>此外 <code>options</code> 方法传入一个<code>Collection</code>对象时，<code>options</code>会自动调用该对象的<code>pluck</code>方法转为<code>[&#39;主键名&#39; =&gt; &#39;显示字段名&#39;]</code> 数组，作为下拉框选项。或者可以直接使用<code>[&#39;主键名&#39; =&gt; &#39;显示字段名&#39;]</code>这样的数组作为参数。</p>
<p><code>tags</code>还支持<code>saving</code>方法用于处理提交的数据，示例如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">tags</span>(<span class="string">&#x27;tags&#x27;</span>, <span class="string">&#x27;文章标签&#x27;</span>)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">pluck</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">options</span>(<span class="title class_">Tag</span>::<span class="title function_ invoke__">all</span>())</span><br><span class="line">    -&gt;<span class="title function_ invoke__">saving</span>(function (<span class="variable">$value</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<p><code>saving</code> 方法接收一个「参数为 tags 的提交值，返回值为修改后的 tags 提交值」的闭包，可以用于实现自动创建新 tag 或其它功能。</p>
<p>如果选项过多，可通过ajax方式动态分页载入选项：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">tags</span>(<span class="string">&#x27;friends&#x27;</span>)-&gt;<span class="title function_ invoke__">options</span>(function (<span class="variable">$ids</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">User</span>::<span class="title function_ invoke__">find</span>((<span class="keyword">array</span>) <span class="variable">$ids</span>)-&gt;<span class="title function_ invoke__">pluck</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">&#125;)-&gt;<span class="title function_ invoke__">ajax</span>(<span class="string">&#x27;api/users&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>API <code>/admin/api/users</code>接口的代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">users</span>(<span class="params">Request <span class="variable">$request</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$q</span> = <span class="variable">$request</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;q&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">User</span>::<span class="title function_ invoke__">where</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;like&#x27;</span>, <span class="string">&quot;%<span class="subst">$q</span>%&quot;</span>)-&gt;<span class="title function_ invoke__">paginate</span>(<span class="literal">null</span>, [<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;name as text&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接口返回的数据结构为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;total&quot;: 4,</span><br><span class="line">    &quot;per_page&quot;: 15,</span><br><span class="line">    &quot;current_page&quot;: 1,</span><br><span class="line">    &quot;last_page&quot;: 1,</span><br><span class="line">    &quot;next_page_url&quot;: null,</span><br><span class="line">    &quot;prev_page_url&quot;: null,</span><br><span class="line">    &quot;from&quot;: 1,</span><br><span class="line">    &quot;to&quot;: 3,</span><br><span class="line">    &quot;data&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: 9,</span><br><span class="line">            &quot;text&quot;: &quot;xxx&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: 21,</span><br><span class="line">            &quot;text&quot;: &quot;xxx&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: 42,</span><br><span class="line">            &quot;text&quot;: &quot;xxx&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;id&quot;: 48,</span><br><span class="line">            &quot;text&quot;: &quot;xxx&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><a name="icon"></a></p>
<h2 id="图标选择器-icon"><a href="#图标选择器-icon" class="headerlink" title="图标选择器 (icon)"></a>图标选择器 (icon)</h2><p>选择<code>font-awesome</code>图标</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">icon</span>(<span class="string">&#x27;icon&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><a name="tree"></a></p>
<h2 id="树形选择器-tree"><a href="#树形选择器-tree" class="headerlink" title="树形选择器 (tree)"></a>树形选择器 (tree)</h2><p>树形结构表单</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">tree</span>(<span class="string">&#x27;permissions&#x27;</span>)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">nodes</span>(<span class="title class_">Model</span>::<span class="title function_ invoke__">get</span>()-&gt;<span class="title function_ invoke__">toArray</span>()) <span class="comment">// 设置所有节点</span></span><br><span class="line">    -&gt;<span class="title function_ invoke__">customFormat</span>(function (<span class="variable">$v</span>) &#123; <span class="comment">// 格式化外部注入的值</span></span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$v</span>) <span class="keyword">return</span> [];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">array_column</span>(<span class="variable">$v</span>, <span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 修改节点的字段名称</span></span><br><span class="line"><span class="comment">// 默认 “id” “name” “parent_id”</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">tree</span>(<span class="string">&#x27;permissions&#x27;</span>)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">nodes</span>(<span class="variable">$permissionModel</span>-&gt;<span class="title function_ invoke__">allNodes</span>())</span><br><span class="line">    -&gt;<span class="title function_ invoke__">setIdColumn</span>(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">setTitleColumn</span>(<span class="string">&#x27;title&#x27;</span>)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">setParentColumn</span>(<span class="string">&#x27;parent&#x27;</span>); </span><br><span class="line">    </span><br><span class="line"><span class="comment">// 默认是不保存父节点的值的，因为一般来说父节点只是作为标题的形式存在</span></span><br><span class="line"><span class="comment">// 禁止过滤父节点的值</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">tree</span>(<span class="string">&#x27;permissions&#x27;</span>)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">nodes</span>(<span class="variable">$permissionModel</span>-&gt;<span class="title function_ invoke__">allNodes</span>())</span><br><span class="line">    -&gt;<span class="title function_ invoke__">exceptParentNode</span>(<span class="literal">false</span>);</span><br><span class="line">    </span><br><span class="line"><span class="comment">// 默认收缩子节点</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">tree</span>(<span class="string">&#x27;permissions&#x27;</span>)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">nodes</span>(<span class="variable">$permissionModel</span>-&gt;<span class="title function_ invoke__">allNodes</span>())</span><br><span class="line">    -&gt;<span class="title function_ invoke__">expand</span>(<span class="literal">false</span>);</span><br></pre></td></tr></table></figure>

<p><code>tree</code>表单默认不允许单独选中父节点，可以通过<code>treeState(false)</code>开启这个功能</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">tree</span>(<span class="string">&#x27;xxx&#x27;</span>)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">treeState</span>(<span class="literal">false</span>) <span class="comment"># 允许单独选择父节点</span></span><br><span class="line">    -&gt;<span class="title function_ invoke__">setTitleColumn</span>(<span class="string">&#x27;title&#x27;</span>)</span><br><span class="line">    -&gt;<span class="title function_ invoke__">nodes</span>(...);</span><br></pre></td></tr></table></figure>

<p>效果</p>
<p><img src="https://cdn.learnku.com/uploads/images/202104/30/38389/oChwzky2BT.gif!large"></p>
<p><a name="table"></a></p>
<h2 id="表格表单-table"><a href="#表格表单-table" class="headerlink" title="表格表单 (table)"></a>表格表单 (table)</h2><p>如果某一个字段存储的是json格式的二维数组，可以使用table表单组件来实现快速的编辑：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">table</span>(<span class="string">&#x27;extra&#x27;</span>, function (NestedForm <span class="variable">$table</span>) &#123;</span><br><span class="line">    <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line">    <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;value&#x27;</span>);</span><br><span class="line">    <span class="variable">$table</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;desc&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>同时在模型里面给这个字段增加访问器和修改器:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getExtraAttribute</span>(<span class="params"><span class="variable">$extra</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">array_values</span>(<span class="title function_ invoke__">json_decode</span>(<span class="variable">$extra</span>, <span class="literal">true</span>) ?: []);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setExtraAttribute</span>(<span class="params"><span class="variable">$extra</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;attributes[<span class="string">&#x27;extra&#x27;</span>] = <span class="title function_ invoke__">json_encode</span>(<span class="title function_ invoke__">array_values</span>(<span class="variable">$extra</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个组件类似于hasMany组件，不过是用来处理单个字段的情况，适用于简单的二维数据。</p>
<p><a name="onemany"></a></p>
<h2 id="一对多-hasMany"><a href="#一对多-hasMany" class="headerlink" title="一对多 (hasMany)"></a>一对多 (hasMany)</h2><p>一对多内嵌表格，用于处理一对多的关系，下面是个简单的例子：</p>
<p>有两张表是一对多关系：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `demo_painters` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_unicode_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `bio` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_unicode_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `created_at` <span class="type">timestamp</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0000-00-00 00:00:00&#x27;</span>,</span><br><span class="line">  `updated_at` <span class="type">timestamp</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0000-00-00 00:00:00&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_unicode_ci;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `demo_paintings` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `painter_id` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `title` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">COLLATE</span> utf8_unicode_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `body` text <span class="keyword">COLLATE</span> utf8_unicode_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `completed_at` <span class="type">timestamp</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0000-00-00 00:00:00&#x27;</span>,</span><br><span class="line">  `created_at` <span class="type">timestamp</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0000-00-00 00:00:00&#x27;</span>,</span><br><span class="line">  `updated_at` <span class="type">timestamp</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0000-00-00 00:00:00&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  KEY painter_id (`painter_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8_unicode_ci;</span><br></pre></td></tr></table></figure>

<p>表的模型为：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Models</span>\<span class="title class_">Demo</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Painter</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">paintings</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">hasMany</span>(<span class="title class_">Painting</span>::<span class="variable language_">class</span>, <span class="string">&#x27;painter_id&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">App</span>\<span class="title class_">Models</span>\<span class="title class_">Demo</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Eloquent</span>\<span class="title">Model</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Painting</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$fillable</span> = [<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;body&#x27;</span>, <span class="string">&#x27;completed_at&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">painter</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">belongsTo</span>(<span class="title class_">Painter</span>::<span class="variable language_">class</span>, <span class="string">&#x27;painter_id&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>构建表单代码如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Models</span>\<span class="title">Demo</span>\<span class="title">Painter</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 这里需要显式地指定关联关系</span></span><br><span class="line"><span class="variable">$builder</span> = <span class="title class_">Painter</span>::<span class="title function_ invoke__">with</span>(<span class="string">&#x27;paintings&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 如果你使用的是数据仓库，则可以这样指定关联关系</span></span><br><span class="line"><span class="comment">// $repository = new Painter([&#x27;paintings&#x27;]);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="title class_">Form</span>::<span class="title function_ invoke__">make</span>(<span class="variable">$builder</span>, function (Form <span class="variable">$form</span>) &#123;</span><br><span class="line">    <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;ID&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;username&#x27;</span>)-&gt;<span class="title function_ invoke__">rules</span>(<span class="string">&#x27;required&#x27;</span>);</span><br><span class="line">    <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">textarea</span>(<span class="string">&#x27;bio&#x27;</span>)-&gt;<span class="title function_ invoke__">rules</span>(<span class="string">&#x27;required&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">hasMany</span>(<span class="string">&#x27;paintings&#x27;</span>, function (Form\NestedForm <span class="variable">$form</span>) &#123;</span><br><span class="line">        <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;title&#x27;</span>);</span><br><span class="line">        <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">textarea</span>(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line">        <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">datetime</span>(<span class="string">&#x27;completed_at&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&#x27;created_at&#x27;</span>, <span class="string">&#x27;Created At&#x27;</span>);</span><br><span class="line">    <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">display</span>(<span class="string">&#x27;updated_at&#x27;</span>, <span class="string">&#x27;Updated At&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 也可以设置label</span></span><br><span class="line">    <span class="comment">// $form-&gt;hasMany(&#x27;paintings&#x27;, &#x27;画作&#x27;, function (Form\NestedForm $form) &#123;</span></span><br><span class="line">    <span class="comment">//    ...</span></span><br><span class="line">    <span class="comment">// &#125;);</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>效果</p>
<p>![](&#x2F;assets&#x2F;img&#x2F;screenshots&#x2F;has-many.png)</p>
<p><a name="has-many-table"></a></p>
<h3 id="表格模式-table"><a href="#表格模式-table" class="headerlink" title="表格模式 (table)"></a>表格模式 (table)</h3><p>如果你想要显示表格模式，可以这样使用</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">Dcat</span>\<span class="title">Admin</span>\<span class="title">Support</span>\<span class="title">Helper</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">hasMany</span>(<span class="string">&#x27;paintings&#x27;</span>, function (Form\NestedForm <span class="variable">$form</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;)-&gt;<span class="title function_ invoke__">useTable</span>();</span><br></pre></td></tr></table></figure>
<p>效果</p>
<a href="/assets/img/screenshots/has-many-table.png" target="_blank">
    <img  src="/assets/img/screenshots/has-many-table.png" style="box-shadow:0 1px 6px 1px rgba(0, 0, 0, 0.12)" width="100%">
</a>


<p><a name="embeds"></a></p>
<h2 id="内嵌-embeds"><a href="#内嵌-embeds" class="headerlink" title="内嵌 (embeds)"></a>内嵌 (embeds)</h2><blockquote>
<p>{tip} 内嵌表单不支持图片和文件上传表单。</p>
</blockquote>
<p>用于处理<code>mysql</code>的<code>JSON</code>类型字段数据或者<code>mongodb</code>的<code>object</code>类型数据，也可以将多个field的数据值以<code>JSON</code>字符串的形式存储在<code>mysql</code>的字符串类型字段中</p>
<p>比如<code>orders</code>表中的<code>JSON</code>或字符串类型的<code>extra</code>字段，用来存储多个field的数据，先定义model:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Order</span> <span class="keyword">extends</span> <span class="title">Model</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$casts</span> = [</span><br><span class="line">        <span class="string">&#x27;extra&#x27;</span> =&gt; <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line">    ];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后在form中使用：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">embeds</span>(<span class="string">&#x27;extra&#x27;</span>, function (<span class="variable">$form</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">text</span>(<span class="string">&#x27;extra1&#x27;</span>)-&gt;<span class="title function_ invoke__">rules</span>(<span class="string">&#x27;required&#x27;</span>);</span><br><span class="line">    <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">email</span>(<span class="string">&#x27;extra2&#x27;</span>)-&gt;<span class="title function_ invoke__">rules</span>(<span class="string">&#x27;required&#x27;</span>);</span><br><span class="line">    <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">mobile</span>(<span class="string">&#x27;extra3&#x27;</span>);</span><br><span class="line">    <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">datetime</span>(<span class="string">&#x27;extra4&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$form</span>-&gt;<span class="title function_ invoke__">dateRange</span>(<span class="string">&#x27;extra5&#x27;</span>, <span class="string">&#x27;extra6&#x27;</span>, <span class="string">&#x27;范围&#x27;</span>)-&gt;<span class="title function_ invoke__">rules</span>(<span class="string">&#x27;required&#x27;</span>);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自定义标题</span></span><br><span class="line"><span class="variable">$form</span>-&gt;<span class="title function_ invoke__">embeds</span>(<span class="string">&#x27;extra&#x27;</span>, <span class="string">&#x27;附加信息&#x27;</span>, function (<span class="variable">$form</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>回调函数里面构建表单元素的方法调用和外面是一样的。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/11/25/2.x/model-form-fields/" data-id="clpdpxfja000zywnad5b8781x" data-title="" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2023/11/25/2.x/model-form-step/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2023/11/25/2.x/model-form-init/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/11/25/2.x/widgets-navbar/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/11/25/2.x/widgets-tab/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/11/25/2.x/widgets-table/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/11/25/2.x/widgets-tooltip/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/11/25/2.x/widgets-js/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>